"use strict";var p=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var w=(l,r)=>{for(var t in r)p(l,t,{get:r[t],enumerable:!0})},y=(l,r,t,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of C(r))!v.call(l,i)&&i!==t&&p(l,i,{get:()=>r[i],enumerable:!(e=u(r,i))||e.enumerable});return l};var P=l=>y(p({},"__esModule",{value:!0}),l);var $={};w($,{default:()=>x});module.exports=P($);var a=require("obsidian"),F={commands:[]};function T(l){let r=5381;for(let t=0;t<l.length;t++)r=r*33^l.charCodeAt(t);return(r>>>0).toString(16)}var m=class extends a.FuzzySuggestModal{constructor(t,e){super(t);this.onChoose=e,this.setPlaceholder("\uD30C\uC77C \uAC80\uC0C9...")}getItems(){return typeof this.app.vault.getMarkdownFiles=="function"?this.app.vault.getMarkdownFiles():this.app.vault.getFiles().filter(t=>t.path.endsWith(".md"))}getItemText(t){return t.path}onChooseItem(t){this.onChoose(t)}},f=class extends a.Plugin{async onload(){await this.loadSettings(),this.registerAllCommands(),this.addCommand({id:"quick-open-add-current-note",name:"\uD604\uC7AC \uD0ED \uB178\uD2B8 \uCD94\uAC00",callback:async()=>{let t=this.app.workspace.getActiveFile();if(!t||!(t instanceof a.TFile)){new a.Notice("\uD65C\uC131 \uD0ED\uC5D0 \uB178\uD2B8\uAC00 \uC5F4\uB824\uC788\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4");return}await this.addCommandForFile(t.path)}}),this.addSettingTab(new g(this.app,this)),this.registerEvent(this.app.vault.on("rename",(t,e)=>{if(!e)return;let i=this.settings.commands.filter(s=>s.filePath===e);if(i.length!==0){for(let s of i){s.filePath=t.path;try{this.app.commands.removeCommand(s.id)}catch{}this.registerCommandForConfig(s)}this.saveSettings(),new a.Notice(`\uBA85\uB839 \uACBD\uB85C \uC5C5\uB370\uC774\uD2B8\uB428: ${e} \u2192 ${t.path}`)}})),this.registerEvent(this.app.vault.on("delete",async t=>{let e=t.path,i=this.settings.commands.filter(s=>s.filePath===e);if(i.length!==0){for(let s of i){let n=this.settings.commands.findIndex(o=>o.id===s.id);n!==-1&&this.settings.commands.splice(n,1);try{this.app.commands.removeCommand(s.id)}catch{}}await this.saveSettings(),new a.Notice(`\uC0AD\uC81C\uB41C \uD30C\uC77C\uC5D0 \uB300\uD55C \uBA85\uB839\uC774 \uC81C\uAC70\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${e}`);try{let s=this.app.workspace.getLeavesOfType("settings");for(let n of s)n.view&&typeof n.view.display=="function"&&n.view.display()}catch{}}}))}onunload(){for(let t of this.settings.commands)try{this.app.commands.removeCommand(t.id)}catch{}}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},F,t)}async saveSettings(){await this.saveData(this.settings)}registerAllCommands(){for(let t of this.settings.commands)this.registerCommandForConfig(t)}registerCommandForConfig(t){let e=t.filePath.split("/").pop()?.replace(/\.md$/,"")||t.filePath,i=t.filePath.substring(0,t.filePath.lastIndexOf("/")),n=`${i?`${i}/${e}`:e} \uC5F4\uAE30`;this.addCommand({id:t.id,name:n,callback:async()=>{let o=this.app.vault.getAbstractFileByPath(t.filePath);if(!o||!(o instanceof a.TFile)){new a.Notice(`\uD30C\uC77C\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: ${t.filePath}`);return}let c=this.app.workspace.activeLeaf||this.app.workspace.getLeaf();c&&await c.openFile(o)}})}async addCommandForFile(t){if(this.settings.commands.some(c=>c.filePath===t)){new a.Notice("\uC774\uBBF8 \uB4F1\uB85D\uB41C \uD30C\uC77C\uC785\uB2C8\uB2E4");return}let i={id:`quick-open-${T(t)}`,filePath:t};this.settings.commands.push(i),this.registerCommandForConfig(i),await this.saveSettings();let s=t.split("/").pop()?.replace(/\.md$/,"")||t,n=t.substring(0,t.lastIndexOf("/")),o=n?`${n}/${s}`:s;new a.Notice(`\uBA85\uB839 \uCD94\uAC00\uB428: ${o} \uC5F4\uAE30`)}async removeCommandById(t){let e=this.settings.commands.findIndex(c=>c.id===t);if(e===-1)return;let[i]=this.settings.commands.splice(e,1);try{this.app.commands.removeCommand(i.id)}catch{}await this.saveSettings();let s=i.filePath.split("/").pop()?.replace(/\.md$/,"")||i.filePath,n=i.filePath.substring(0,i.filePath.lastIndexOf("/")),o=n?`${n}/${s}`:s;new a.Notice(`\uBA85\uB839 \uC0AD\uC81C\uB428: ${o} \uC5F4\uAE30`)}},g=class extends a.PluginSettingTab{constructor(t,e){super(t,e);this.filterText="";this.listContainer=null;this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Quick Open Commands"});let e=t.createDiv({cls:"quick-open-search"});new a.SearchComponent(e).setPlaceholder("\uBA85\uB839 \uB610\uB294 \uD30C\uC77C \uAC80\uC0C9...").setValue(this.filterText).onChange(s=>{this.filterText=s,this.updateList()}),new a.Setting(t).addButton(s=>{s.setButtonText("+ \uC0C8 \uBA85\uB839 \uCD94\uAC00").onClick(()=>{let n=new m(this.app,async o=>{await this.plugin.addCommandForFile(o.path),this.display(),n.close()});n.open()})}),this.listContainer=t.createDiv(),this.updateList()}updateList(){if(!this.listContainer)return;this.listContainer.empty();let t=this.plugin.settings.commands.filter(e=>{if(!this.filterText)return!0;let i=this.filterText.toLowerCase();return(e.filePath.split("/").pop()?.replace(/\.md$/,"")||e.filePath).toLowerCase().includes(i)||e.filePath.toLowerCase().includes(i)});if(t.length===0){this.listContainer.createEl("div",{text:"\uD574\uB2F9 \uAC80\uC0C9\uC5B4\uC640 \uC77C\uCE58\uD558\uB294 \uBA85\uB839\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uAC80\uC0C9\uC5B4\uB97C \uBCC0\uACBD\uD574 \uBCF4\uC138\uC694."});return}for(let e of t){let i=e.filePath.split("/").pop()?.replace(/\.md$/,"")||e.filePath,s=e.filePath.substring(0,e.filePath.lastIndexOf("/")),n=s?`${s}/${i}`:i,o=new a.Setting(this.listContainer).setName(`${n} \uC5F4\uAE30`),c=this.app.vault.getAbstractFileByPath(e.filePath);if(!c||!(c instanceof a.TFile)){let d=o.nameEl;d.createEl("span",{text:" \u26A0\uFE0F",attr:{title:"\uD30C\uC77C\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4"}}).style.color="var(--interactive-danger)",o.nameEl.style.color="var(--interactive-danger)"}o.addExtraButton(d=>{d.setIcon("square-arrow-out-up-right").setTooltip("\uC0C8 \uD0ED\uC5D0\uC11C \uC5F4\uAE30").onClick(async()=>{let h=this.app.vault.getAbstractFileByPath(e.filePath);h&&h instanceof a.TFile?await this.app.workspace.getLeaf("tab").openFile(h):new a.Notice("\uD30C\uC77C\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4")})}),o.addExtraButton(d=>{d.setIcon("trash").setTooltip("\uC0AD\uC81C").onClick(async()=>{await this.plugin.removeCommandById(e.id),this.display()})})}}},x=f;
